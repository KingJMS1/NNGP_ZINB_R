% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ZINB_NNGP_final.R
\name{ZINB_NNGP}
\alias{ZINB_NNGP}
\title{ZINB_NNGP}
\usage{
ZINB_NNGP(
  X,
  y,
  coords,
  Vs,
  Vt,
  Ds,
  Dt,
  M = 10,
  nsim,
  burn,
  thin = 1,
  save_ypred = FALSE,
  print_iter = 100,
  print_progress = FALSE
)
}
\arguments{
\item{X}{Other Predictor variables}

\item{y}{Zero inflated count response}

\item{coords}{Spatial coordinates for NNGP}

\item{Vs}{Spatially varying predictor variables (e.g. one-hot indication of which location this is for varying intercept), wrapped in sparseMatrix from Matrix R package. Will be multiplied by the spatial random effects for prediction.}

\item{Vt}{Temporal varying predictor variables, wrapped in sparseMatrix from Matrix R package. Will be multiplied by the temporal random effects for prediction.}

\item{Ds}{Spatial distance matrix, diagonal should be 0, off diagonal is distance between elements i and j in space, inputs to the spatial NNGP kernel}

\item{Dt}{Temporal distance matirx, diagonal should be 0, off diagonal is distance between elements i and j in time, inputs to the temporal GP kernel}

\item{M}{How many neighbors to allow in the spatial NNGP algorithm, defaults to 10.}

\item{nsim}{How long to run MCMC in total, must be greater than burn.}

\item{burn}{How long to run MCMC before saving samples.}

\item{thin}{How often to save MCMC samples, default is 1, saves every iteration.}

\item{save_ypred}{Whether or not to output the predicted values at every iteration}

\item{print_iter}{How often to print the iteration number of the MCMC chain.}

\item{print_progress}{Whether or not to print the iteration number of the MCMC chain.}
}
\value{
A List of the following sampled values:
\itemize{
\item {\strong{Alpha:} } {Model coefficients for logit model}
\item {\strong{Beta:} } {Model coefficients for NB model}
\item {\strong{A:} } {Portion of spatial random effect in the logit model explained by kernel}
\item {\strong{B:} } {Portion of temporal random effect in the logit model explained by kernel}
\item {\strong{C:} } {Portion of spatial random effect in the NB model explained by kernel}
\item {\strong{D:} } {Portion of temporal random effect in the NB model explained by kernel}
\item {\strong{Eps1s:} } {Portion of spatial random effect in the logit model explained by noise}
\item {\strong{Eps2s:} } {Portion of spatial random effect in the NB model explained by noise}
\item {\strong{Eps1t:} } {Portion of temporal random effect in the logit model explained by noise}
\item {\strong{Eps2t:} } {Portion of temporal random effect in the NB model explained by noise}
\item {\strong{L1t:} } {Length scale for temporal kernel in logit model, i.e. } \eqn{e^{-\frac{d^{2}}{2 l_{1t}^{2}}}}
\item {\strong{Sigma1t:} } {Kernel scale parameter for above kernel, i.e. } \eqn{\sigma_{1t}^{2}e^{.}}
\item {\strong{L2t:} } {Length scale for temporal kernel in NB model, i.e. } \eqn{e^{-\frac{d^{2}}{2 l_{1t}^{2}}}}
\item {\strong{Sigma2t:} } {Kernel scale parameter for above kernel, i.e. } \eqn{\sigma_{2t}^{2}e^{.}}
\item {\strong{Phi_bin:} } {Length scale for spatial kernel in logit model, i.e. } \eqn{e^{-\Phi_{bin}d^{2}}}
\item {\strong{Sigma1s:} } {Square root of multiplier for spatial kernel in logit model}
\item {\strong{Phi_nb:} } {Length scale for spatial kernel in NB model, i.e. } \eqn{e^{-\Phi_{nb}d^{2}}}
\item {\strong{Sigma2s:} } {Square root of multiplier for spatial kernel in NB model}
\item {\strong{Sigma_eps1s:} } {Estimated Standard deviation for eps1s}
\item {\strong{Sigma_eps2s:} } {Estimated Standard deviation for eps2s}
\item {\strong{Sigma_eps1t:} } {Estimated Standard deviation for eps1t}
\item {\strong{Sigma_eps2t:} } {Estimated Standard deviation for eps2t}
\item {\strong{R:} } {Dispersion parameter for Negative Binomial distribution.}
\item {\strong{at_risk:} } {At risk indicator for each observation}
\item {\strong{Y_pred:} } {Predictions, sampled from the posterior distribution at each iteration, NULL if save_ypred is false}
}
}
\description{
Run the ZINB NNGP model described in https://doi.org/10.1016/j.jspi.2023.106098.
}
